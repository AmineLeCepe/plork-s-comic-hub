<link rel="stylesheet" href="/css/navbar2.css">
<div class="secondary-navbar">
    <input type="text" class="search-input" placeholder="Search..." />
    <img src="/assets/default-avatar.png" alt="Profile" class="profile-icon" id="profileIcon"/>
</div>

<!-- Profile Modal -->
<div id="profileModal" class="profile-modal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="user-info">
                <img src="/assets/default-avatar.png" alt="Profile" class="modal-profile-img"/>
                <div class="user-details">
                    <h3 class="username">Username</h3>
                    <span class="user-status">Member since 2025</span>
                </div>
            </div>
            <span class="close-modal">&times;</span>
        </div>
        <div class="modal-body">
            <ul class="profile-menu">
                <li class="profile-menu-item">
                    <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                    <a href="/profile">My Profile</a>
                </li>
                <li class="profile-menu-item">
                    <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg>
                    <a href="/bookmarks">My Bookmarks</a>
                </li>
                <li class="profile-menu-item">
                    <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>
                    <a href="/reading-history">Reading History</a>
                </li>
                <li class="profile-menu-item">
                    <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                    <a href="/settings">Settings</a>
                </li>
            </ul>
        </div>
        <div class="modal-footer">
            <button class="sign-out-btn">
                <svg xmlns="http://www.w3.org/2000/svg" height="18" width="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                Sign Out
            </button>
        </div>
    </div>
</div>

<script>
    // Get the modal
    const modal = document.getElementById("profileModal");
    
    // Get the button that opens the modal
    const profileIcon = document.getElementById("profileIcon");
    
    // Get the <span> element that closes the modal
    const closeBtn = document.getElementsByClassName("close-modal")[0];
    
    // Position the modal content correctly beneath the profile icon
    function positionModal() {
        const profileRect = profileIcon.getBoundingClientRect();
        const modalContent = document.querySelector(".modal-content");
        
        // Calculate position to align it with the profile icon
        const top = profileRect.bottom + window.scrollY + 10; // 10px below the profile icon
        const right = window.innerWidth - profileRect.right - (profileRect.width / 2);
        
        modalContent.style.top = `${top}px`;
        modalContent.style.right = `${right}px`;
    }
    
    // When the user clicks on the profile icon, open the modal
    profileIcon.onclick = function() {
        positionModal(); // Position the modal before showing it
        modal.style.display = "block";
        setTimeout(() => {
            modal.classList.add("active");
        }, 10);
    }
    
    // When the user clicks on <span> (x), close the modal
    closeBtn.onclick = function() {
        modal.classList.remove("active");
        setTimeout(() => {
            modal.style.display = "none";
        }, 300);
    }
    
    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.classList.remove("active");
            setTimeout(() => {
                modal.style.display = "none";
            }, 300);
        }
    }
    
    // Reposition modal if window is resized
    window.addEventListener('resize', function() {
        if (modal.style.display === "block") {
            positionModal();
        }
    });
</script>