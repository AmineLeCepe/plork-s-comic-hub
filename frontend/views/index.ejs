<!doctype html>
<html lang="en">
    <title>Home</title>
    <%- include("partials/head" )%>
    <%
        let sampleComic1 = {
            name: 'Comic 1',
            tags: ["Tag 1", "Tag 2", "Tag 3"]
        }
        let sampleChapter1 = {
            title: "Chapter 1",
            description: "Placeholder desc",
            number: 1,
            pages: 40,
            cover: "/assets/chapter-placeholder.png",
            date: Date.now()
        }

        let sampleComic2 = {
            name: 'Comic 2',
            tags: ["Tag 1", "Tag 2", "Tag 3"]
        }
        let sampleChapter2 = {
            title: "Chapter 2",
            description: "Placeholder desc 2",
            number: 1,
            pages: 40,
            cover: "/assets/chapter-placeholder.png",
            date: Date.now()
        }
    %>

<body>
    <%- include("partials/navbar") %>
    <div class="main-content">
        <%- include("partials/navbar2") %>
        <div class="currently-trending">
            <h1>Currently Trending</h1>

            <div class="carousel-container">
                <button class="carousel-btn prev">‹</button>

                <div class="carousel-track">
                    <%
                    let sampleData = [
                        {comic: sampleComic1, chapter: sampleChapter1},
                        {comic: sampleComic2, chapter: sampleChapter2}
                    ];

                            for(let item of sampleData) {
                    %>
                        <div class="carousel-item">
                            <img src="<%= item.chapter.cover %>" alt="Chapter Thumbnail" class="chapter-thumbnail"/>
                            <div class="chapter-info">
                                <h3 class="comic-name"><%= item.comic.name %></h3>
                                <h5 class="tags">
                                    <% for(let tag of item.comic.tags) { %>
                                        <span class="tag"><%= tag %></span>
                                    <% } %>
                                </h5>
                                <h4 class="chapter-title"><%= item.chapter.number%>. <%= item.chapter.title %></h4>
                                <p class="chapter-description"><%= item.chapter.description %></p>
                                <span class="chapter-date">Released: <%= new Date(item.chapter.date).toLocaleDateString() %></span>
                            </div>
                        </div>
                    <% } %>
                </div>

                <button class="carousel-btn next">›</button>
            </div>
        </div>
        <div class="latest">
            <h1>Latest Releases</h1>
            <div class="latest-container">
                <!-- Column 1 -->
                <div class="latest-column">
                    <% 
                    // Render every 3rd item starting from index 0 to form column 1
                    if (typeof latestChapters !== 'undefined') {
                        for (let i = 0; i < latestChapters.length; i += 3) {
                            const ch = latestChapters[i];
                            if (!ch) continue;
                    %>
                        <div class="latest-chapter-item">
                            <a href="/chapter?chapterid=<%= ch._id %>" class="chapter-link">
                                <div class="chapter-header">
                                    <img src="<%= ch.comic?.cover || '/assets/chapter-placeholder.png' %>" alt="Chapter Thumbnail" class="chapter-thumbnail-small"/>
                                    <div class="chapter-info-small">
                                        <h4 class="comic-name-small"><%= ch.comic?.title || 'Untitled Comic' %></h4>
                                        <h5 class="chapter-title-small"><%= ch.chapterNumber %>. <%= ch.title %></h5>
                                        <span class="chapter-date-small">Released: <%= new Date(ch.releaseDate).toLocaleDateString() %></span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    <% 
                        } 
                    } 
                    %>
                </div>
                
                <!-- Column 2 -->
                <div class="latest-column">
                    <% 
                    // Render every 3rd item starting from index 1 to form column 2
                    if (typeof latestChapters !== 'undefined') {
                        for (let i = 1; i < latestChapters.length; i += 3) {
                            const ch = latestChapters[i];
                            if (!ch) continue;
                    %>
                        <div class="latest-chapter-item">
                            <a href="/chapter?chapterid=<%= ch._id %>" class="chapter-link">
                                <div class="chapter-header">
                                    <img src="<%= ch.comic?.cover || '/assets/chapter-placeholder.png' %>" alt="Chapter Thumbnail" class="chapter-thumbnail-small"/>
                                    <div class="chapter-info-small">
                                        <h4 class="comic-name-small"><%= ch.comic?.title || 'Untitled Comic' %></h4>
                                        <h5 class="chapter-title-small"><%= ch.chapterNumber %>. <%= ch.title %></h5>
                                        <span class="chapter-date-small">Released: <%= new Date(ch.releaseDate).toLocaleDateString() %></span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    <% 
                        } 
                    } 
                    %>
                </div>
                
                <!-- Column 3 -->
                <div class="latest-column">
                    <% 
                    // Render every 3rd item starting from index 2 to form column 3
                    if (typeof latestChapters !== 'undefined') {
                        for (let i = 2; i < latestChapters.length; i += 3) {
                            const ch = latestChapters[i];
                            if (!ch) continue;
                    %>
                        <div class="latest-chapter-item">
                            <a href="/chapter?chapterid=<%= ch._id %>" class="chapter-link">
                                <div class="chapter-header">
                                    <img src="<%= ch.comic?.cover || '/assets/chapter-placeholder.png' %>" alt="Chapter Thumbnail" class="chapter-thumbnail-small"/>
                                    <div class="chapter-info-small">
                                        <h4 class="comic-name-small"><%= ch.comic?.title || 'Untitled Comic' %></h4>
                                        <h5 class="chapter-title-small"><%= ch.chapterNumber %>. <%= ch.title %></h5>
                                        <span class="chapter-date-small">Released: <%= new Date(ch.releaseDate).toLocaleDateString() %></span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    <% 
                        } 
                    } 
                    %>
                </div>
            </div>
        </div>
    </div>


    <%- include("partials/scripts")%>
</body>
</html>